<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Ethereum </title>

    <link rel="stylesheet" type="text/css" href="main.css">

    <script src="./node_modules/web3/dist/web3.min.js"></script>

    <link href="/favicon.ico" type="image/x-icon" rel="icon" />

</head>
<body>
    <div class="container">

        <h1>Voting System </h1>
      
        <h2 id="instructor"></h2>
		
		<h1>Enroll Candidate</h1>

        <label for="Id" class="col-lg-2 control-label">Voter Id</label>
        <input id="ec_VoterId" type="text">

		<label for="name" class="col-lg-2 control-label"> Voter Name</label>
        <input id="ec_VoterName" type="text">

        <label for="age" class="col-lg-2 control-label"> Voter Age</label>
        <input id="ec_VoterAge" type="text">

		<button id="button_enrollCandidate">Enroll Candidate</button>

		<h1>Enroll Voter</h1>

        <label for="Id" class="col-lg-2 control-label">Voter Id</label>
        <input id="ev_VoterId" type="text">

		<label for="name" class="col-lg-2 control-label"> Voter Name</label>
        <input id="ev_VoterName" type="text">

        <label for="age" class="col-lg-2 control-label"> Voter Age</label>
        <input id="ev_VoterAge" type="text">

		<button id="button_enrollVoter">Enroll Voter</button>

		<h1>Get Voter Details</h1>

        <label for="voterId" class="col-lg-2 control-label">Voter Id</label>
        <input id="gvd_VoterId" type="text">

		<button id="button_getVoterDetails">Get Voter Details</button>

		<h1>Get Candidate Details</h1>

        <label for="CandidateId" class="col-lg-2 control-label">Candidate Id</label>
        <input id="gcd_VoterId" type="text">

		<button id="button_getCandidateDetails">Get Candidate Details</button>

		<h1>Vote</h1>

        <label for="CandidateId" class="col-lg-2 control-label">Voter Id</label>
        <input id="vote_VoterId" type="text">

		<label for="CandidateId" class="col-lg-2 control-label">Candidate Id</label>
        <input id="vote_CandiadteId" type="text">

		<button id="button_vote">Vote</button>

		<h1>Get Vote Count Of</h1>

		<label for="CandidateId" class="col-lg-2 control-label">Candidate Id</label>
        <input id="gvc_CandiadteId" type="text">

	
		<button id="button_getVotecountOf">Get Vote Count</button>

		<h1>Get Voter List</h1>

		<button id="button_getVoterList">Get Voter List</button>

		<h1>Get Candidate List</h1>

		<button id="button_getCandidateList">Get Candidate List</button>

    
    </div>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>

    <script>
       if (typeof web3 !== 'undefined') {
           web3 = new Web3(web3.currentProvider);
       } else {
           web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:8545"));
       }

	
       web3.eth.defaultAccount = web3.eth.accounts[0];	    


	   console.log(web3.eth.accounts[0]);
	   console.log(web3.eth.Balance);

       var votingContract = web3.eth.contract([
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "_voterId",
				"type": "uint256"
			},
			{
				"internalType": "string",
				"name": "_name",
				"type": "string"
			},
			{
				"internalType": "uint256",
				"name": "_age",
				"type": "uint256"
			}
		],
		"name": "enrollCandidate",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "_voterId",
				"type": "uint256"
			},
			{
				"internalType": "string",
				"name": "_name",
				"type": "string"
			},
			{
				"internalType": "uint256",
				"name": "_age",
				"type": "uint256"
			}
		],
		"name": "enrollVoter",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "_candidateVoterId",
				"type": "uint256"
			},
			{
				"internalType": "uint256",
				"name": "_votersVoterId",
				"type": "uint256"
			}
		],
		"name": "vote",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "_voterId",
				"type": "uint256"
			}
		],
		"name": "getCandidateDetails",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			},
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			},
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			},
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "getCandidateList",
		"outputs": [
			{
				"internalType": "uint256[]",
				"name": "",
				"type": "uint256[]"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "_voterId",
				"type": "uint256"
			}
		],
		"name": "getVotecountOf",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "_voterId",
				"type": "uint256"
			}
		],
		"name": "getVoterDetails",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			},
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			},
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			},
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "getVoterList",
		"outputs": [
			{
				"internalType": "uint256[]",
				"name": "",
				"type": "uint256[]"
			}
		],
		"stateMutability": "view",
		"type": "function"
	}
]);

       var Vote = votingContract.at('0x4b11aB4D841B80EcD1581ecbFa5215E589a7D972');


	   $("#button_getVoterDetails").click(function() {

		Vote.getVoterDetails($("#gvd_VoterId").val(),function(error, result) {
			if (!error) {
				$("#instructor").html("Voter Id: "+result[0]+"</br>"+ "Name: "+result[1]+"</br>"+"Age: "+result[2]+"</br>"+"Voting Sate: "+result[3]);
			} else
					console.log(error);
		});
	});


      $("#button_getCandidateDetails").click(function() {

		Vote.getCandidateDetails($("#gcd_VoterId").val(),function(error, result) {    
           if (!error) {
               $("#instructor").html("Voter Id: "+result[0]+"</br>"+ "Name: "+result[1]+"</br>"+"Age: "+result[2]+"</br>"+"Voting Count: "+result[3]);
           } else
                console.log(error);
	   });
	});

	$("#button_getVotecountOf").click(function() {

		Vote.getVotecountOf($("#gvc_CandiadteId").val(),function(error, result) {
			if (!error) {
				$("#instructor").html("Vote Count: "+result.c);
			} else
					console.log(error);
		});
	});


       $("#button_enrollCandidate").click(function() {
           
        Vote.enrollCandidate($("#ec_VoterId").val(), $("#ec_VoterName").val(),$("#ec_VoterAge").val(), (err, res) => {
				if (err){
					console.log(err);
					}    
        })
            
		});
		

		$("#button_enrollVoter").click(function() {
           
		   Vote.enrollVoter($("#ev_VoterId").val(), $("#ev_VoterName").val(),$("#ev_VoterAge").val(), (err, res) => {
				if (err){
					console.log(err);
					}    
				})
					
		   });

		   $("#button_vote").click(function() {
           
			 Vote.vote($("#vote_VoterId").val(), $("#vote_CandiadteId").val(), (err, res) => {
					if (err){
							console.log(err);
						}    
					})
				
		   });




	$("#button_getVoterList").click(function() {

		Vote.getVoterList(function(error, result) {
		if (!error) {
			for(i=0;i<result.length;i++){
               $("#instructor").append(result[i]+'<br/>');
			   console.log(result[i]);
			   }
		} else
				console.log(error);
		});

	});


	$("#button_getCandidateList").click(function() {

		Vote.getCandidateList(function(error, result) {
			if (!error) {
				for(i=0;i<result.length;i++){
				$("#instructor").append(result[i]+'<br/>');
				console.log(result[i]);
			}
		} else
				console.log(error);
		});

});


    </script>

</body>
</html>